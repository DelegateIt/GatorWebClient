<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="chat-bubble">
  <template>
    <style>
      :host {
        display: block;
      }

      .bubble {
        background-color: #F2F2F2;
        border-radius: 5px;
        box-shadow: 0 0 6px #B2B2B2;
        display: inline-block;
        padding: 10px 18px;
        position: relative;
        vertical-align: top;
      }

      .bubble.left:not(.arrow) {
        margin-left: calc(var(--chat-avatar-size) + 20px);
      }

      .bubble.right:not(.arrow) {
        margin-right: calc(var(--chat-avatar-size) + 20px);
      }

      .bubble.arrow::before {
        background-color: #F2F2F2;
        content: "\00a0";
        display: block;
        height: 16px;
        position: absolute;
        top: 11px;
        transform: rotate( 29deg) skew( -35deg);
        width: 20px;
      }

      .bubble.left {
        margin: 5px 45px 5px 20px;
        background-color: var(--chat-bubble-left-background-color);
        color: var(--chat-bubble-left-color);
      }

      .bubble.left.arrow::before {
        box-shadow: -2px 2px 2px 0 rgba( 178, 178, 178, .4);
        left: -9px;
        background-color: var(--chat-bubble-left-background-color);
      }

      .bubble.right {
        margin: 5px 20px 5px 45px;
        background-color: var(--chat-bubble-right-background-color);
        color: var(--chat-bubble-right-color);
      }

      .bubble.right.arrow::before {
        box-shadow: 2px -2px 2px 0 rgba( 178, 178, 178, .4);
        right: -9px;
        background-color: var(--chat-bubble-right-background-color);
      }

      .float-left {
        float: left;
      }

      .float-right {
        float: right;
      }

      img {
        border-radius: 5px;
        width: var(--chat-avatar-size);
        height: var(--chat-avatar-size);
        margin-top: 5px;
      }
    </style>
    <template is="dom-if" if="{{isLeft(position)}}">
      <div class="horizontal layout float-left">
        <template is="dom-if" if="{{avatar}}">
          <img src$="{{avatar}}" />
        </template>
        <div class$="bubble {{position}} {{arrow}}">
          <span>{{text}}</span>
        </div>
        </div>
    </template>

    <template is="dom-if" if="{{!isLeft(position)}}">
      <div class="horizontal layout float-right">
        <div class$="bubble {{position}} {{arrow}}">
          <span>{{text}}</span>
        </div>
        <template is="dom-if" if="{{avatar}}">
          <img src$="{{avatar}}" />
        </template>
        </div>
    </template>

  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'chat-bubble',
        properties: {
          text: {
            type: String,
            value: 'Error retreiving message, please refresh page.'
          },
          position: {
            type: String,
            value: 'left'
          },
          arrow: {
            type: String,
            value: '',
          }
        },
        isLeft: function(item) {
          return item === 'left';
        }
      });
    })();
</script>
</dom-module>
